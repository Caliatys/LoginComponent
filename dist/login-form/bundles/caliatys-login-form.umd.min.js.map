{"version":3,"sources":["ng://@caliatys/login-form/lib/validators/usr.validator.ts","ng://@caliatys/login-form/lib/enums/layouts.enum.ts","ng://@caliatys/login-form/lib/enums/themes.enum.ts","ng://@caliatys/login-form/lib/enums/forms.enum.ts","ng://@caliatys/login-form/lib/enums/user-policies.enum.ts","ng://@caliatys/login-form/lib/layouts/modal-wrapper/modal-wrapper.component.ts","ng://@caliatys/login-form/lib/login-form.component.ts","ng://@caliatys/login-form/lib/layouts/tab-wrapper/tab-wrapper.component.ts","ng://@caliatys/login-form/lib/validators/pwd.validator.ts","ng://@caliatys/login-form/lib/forms/pwd-form/pwd-form.component.ts","ng://@caliatys/login-form/lib/forms/mfa-setup-form/mfa-setup-form.component.ts","ng://@caliatys/login-form/lib/forms/mfa-form/mfa-form.component.ts","ng://@caliatys/login-form/lib/pipes/exists-layout.pipe.ts","null","ng://@caliatys/login-form/lib/login-form.module.ts"],"names":["UsrValidator","custom","regexp","control","value","test","email","phone","ModalWrapperComponent","dialogRef","data","this","Forms","EventEmitter","loadParams","prototype","ngOnInit","ngOnDestroy","closeSub","unsubscribe","relayFirstLogEvent","$event","relayFirstLog","emit","relayLostPwdEvent","relayLostPwd","relaySaveMfaKeyEvent","relaySaveMfaKey","relaySendMfaCodeEvent","relaySendMfaCode","formType","labels","errors","inputs","isFirst","pwdPolicies","code","qrCode","closeEvent","subscribe","res","_this","close","Component","args","selector","template","styles","MatDialogRef","Inject","MAT_DIALOG_DATA","LoginFormComponent","dialog","sanitizer","iconRegistry","builder","UserPolicies","Layouts","addSvgIcon","bypassSecurityTrustResourceUrl","initFormGroups","initFormLayouts","initTheme","initPolicies","initIcons","initButtons","initInputs","initErrors","initLabels","ngAfterViewInit","initialized","ngOnChanges","changes","modalFirstSub","modalLostSub","modalSaveMfaKeySub","modalSendMfaCodeSub","onClickLogin","event","getEventResponse","login","onClickLoginSocial","social","loginSocial","onClickSignUp","signUp","onClickForgotPassword","forgotPwd","showPwdForm","PWD","showLayout","formLayouts","pwd","showMfaSetupForm","MFA_SETUP","mfaSetup","showMfaForm","MFA","mfa","hidePwdForm","closeLayout","password","hideMfaSetupForm","hideMfaForm","showPwdStep","userInfo","userImage","selectedTab","onClickNextStep","currentStep","eventUsr","stepUsr","eventPwd","stepPwd","onClickPrevStep","tabFirstLog","sendFirstPwd","tabLostPwd","sendResetPwd","tabSaveMfaKey","saveMfaKey","tabSendMfaCode","sendMfaCode","modalFirstLog","componentInstance","modalLostPwd","modalSaveMfaKey","modalSendMfaCode","onClickCloseTab","closeTab","openModal","params","closeModalEvent","open","afterClosed","result","formGroup","controls","setValue","formLayout","TAB","openTab","MODAL","INLINE","disable","closeModal","enable","googleStyle","onlyOne","username","usrFormGroup","pwdFormGroup","defaultFormLayouts","Object","assign","customFormLayouts","theme","googleTheme","Themes","defaultIcons","icons","iconUsrOnLoginForm","iconPwdOnLoginForm","customIcons","defaultButons","buttons","forgotPassword","google","facebook","customButtons","defaultInputs","clearUsrOnLoginForm","showPwdOnLoginForm","showPwdOnPwdForm","clearCodeOnPwdForm","clearCodeOnMfaForm","customInputs","defaultErrors","customErrors","defaultPwdPolicies","range","min","max","char","number","lower","upper","customPwdPolicies","customUsrPolicy","validators","EMAIL","push","PHONE","regExp","RegExp","Validators","required","setValidators","defaultLabels","header","titlePwd","subtitlePwd","titlePwdSetup","subtitlePwdSetup","titleMfa","subtitleMfa","titleMfaSetup","subtitleMfaSetup","input","verifCode","newPassword","button","signIn","next","back","send","save","googleSignIn","facebookSignIn","policy","nonWhitespace","sixDigits","customRegex","pwdLength","pwdUppercase","pwdLowercase","pwdNumber","pwdSpecial","customLabels","group","FormControl","disabled","MatDialog","DomSanitizer","MatIconRegistry","FormBuilder","Input","Output","TabWrapperComponent","backToLogin","sendCloseTab","PwdValidator","longEnough","length","PwdFormComponent","firstConnection","lostPassword","refresh","rangeLabel","replace","pwdLengthReplaced","MfaSetupFormComponent","saveMfa","MfaFormComponent","sendMfa","ExistsLayoutPipe","transform","layout","exist","_a","o","m","Symbol","iterator","i","call","done","tslib_1.__values","keys","_b","Pipe","name","MaterialModule","NgModule","exports","MatButtonModule","MatInputModule","MatIconModule","MatDialogModule","MatTabsModule","imports","CommonModule","FormsModule","ReactiveFormsModule","QRCodeModule","declarations","providers","entryComponents"],"mappings":"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","sourcesContent":["import { FormControl }     from '@angular/forms';\r\nimport { AbstractControl } from '@angular/forms';\r\nimport { ValidatorFn }     from '@angular/forms';\r\n\r\nexport interface ValidationResult\r\n{\r\n  [key : string] : boolean;\r\n}\r\n\r\nexport class UsrValidator\r\n{\r\n  public static custom(regexp : RegExp) : ValidatorFn\r\n  {\r\n    let func = (control : AbstractControl) : { [key : string] : boolean } | null =>\r\n    {\r\n      let isRespectful = control.value !== null && regexp.test(control.value);\r\n      if ( !isRespectful )\r\n        return { custom : true };\r\n\r\n      return null;\r\n    };\r\n    return func;\r\n  }\r\n\r\n  public static email(control : FormControl) : ValidationResult\r\n  {\r\n    let isEmail = control.value !== null && /[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}/.test(control.value);\r\n    if ( !isEmail )\r\n      return { email: true };\r\n\r\n    return null;\r\n  }\r\n\r\n  public static phone(control : FormControl) : ValidationResult\r\n  {\r\n    let isPhone = control.value !== null && /^\\+?\\d*$/.test(control.value);\r\n    if ( !isPhone )\r\n      return { phone: true };\r\n\r\n    return null;\r\n  }\r\n\r\n}\r\n","export enum Layouts\r\n{\r\n  MODAL  = 'modal',\r\n  TAB    = 'tab',\r\n  INLINE = 'inline'\r\n}\r\n","export enum Themes\r\n{\r\n  LIGHT = 'light',\r\n  DARK  = 'dark'\r\n}\r\n","export enum Forms\r\n{\r\n  PWD       = 'pwd',\r\n  MFA_SETUP = 'mfaSetup',\r\n  MFA       = 'mfa'\r\n}\r\n","export enum UserPolicies\r\n{\r\n  EMAIL  = 'email',\r\n  PHONE  = 'phone'\r\n}\r\n","// Angular modules\r\nimport { Component }       from '@angular/core';\r\nimport { OnInit }          from '@angular/core';\r\nimport { OnDestroy }       from '@angular/core';\r\nimport { Inject }          from '@angular/core';\r\nimport { EventEmitter }    from '@angular/core';\r\nimport { MatDialogRef }    from '@angular/material';\r\nimport { MAT_DIALOG_DATA } from '@angular/material';\r\n\r\n// External modules\r\nimport { Subscription }    from 'rxjs/Subscription';\r\n\r\n// Enum\r\nimport { Forms }           from '../../enums/forms.enum';\r\n\r\n@Component({\r\n  selector    : 'cal-modal-wrapper',\r\n  template: `<div class=\"header py-2 px-4\">\r\n  <div class=\"row align-items-center\">\r\n    <div class=\"col\">\r\n      <div *ngIf=\"!isFirst && formType === forms.PWD\">\r\n        <span class=\"h5 font-weight-light {{ labels.header.subtitlePwd ? 'd-block mb-0' : '' }}\">\r\n          {{ labels.header.titlePwd }}\r\n        </span>\r\n        <span *ngIf=\"labels.header.subtitlePwd\" class=\"d-block font-weight-light small\">\r\n          {{ labels.header.subtitlePwd }}\r\n        </span>\r\n      </div>\r\n      <div *ngIf=\"isFirst && formType === forms.PWD\">\r\n        <span class=\"h5 font-weight-light {{ labels.header.subtitlePwdSetup ? 'd-block mb-0' : '' }}\">\r\n          {{ labels.header.titlePwdSetup }}\r\n        </span>\r\n        <span *ngIf=\"labels.header.subtitlePwdSetup\" class=\"d-block font-weight-light small\">\r\n          {{ labels.header.subtitlePwdSetup }}\r\n        </span>\r\n      </div>\r\n      <div *ngIf=\"formType === forms.MFA\">\r\n        <span class=\"h5 font-weight-light {{ labels.header.subtitleMfa ? 'd-block mb-0' : '' }}\">\r\n          {{ labels.header.titleMfa }}\r\n        </span>\r\n        <span *ngIf=\"labels.header.subtitleMfa\" class=\"d-block font-weight-light small\">\r\n          {{ labels.header.subtitleMfa }}\r\n        </span>\r\n      </div>\r\n      <div *ngIf=\"formType === forms.MFA_SETUP\">\r\n        <span class=\"h5 font-weight-light {{ labels.header.subtitleMfaSetup ? 'd-block mb-0' : '' }}\">\r\n          {{ labels.header.titleMfaSetup }}\r\n        </span>\r\n        <span *ngIf=\"labels.header.subtitleMfaSetup\" class=\"d-block font-weight-light small\">\r\n          {{ labels.header.subtitleMfaSetup }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-2 px-0 text-right\">\r\n      <button mat-icon-button mat-dialog-close>\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n<mat-dialog-content class=\"py-4\">\r\n  <!-- NOTE: Pwd Form -->\r\n  <cal-pwd-form *ngIf=\"formType === forms.PWD\" \r\n    [isFirst]=\"isFirst\" \r\n    [pwdPolicies]=\"pwdPolicies\" \r\n    [labels]=\"labels\" \r\n    [inputs]=\"inputs\" \r\n    [errors]=\"errors\" \r\n    (firstConnection)=\"relayFirstLogEvent($event)\" \r\n    (lostPassword)=\"relayLostPwdEvent($event)\">\r\n  </cal-pwd-form>\r\n  <!-- NOTE: MFA Setup Form -->\r\n  <cal-mfa-setup-form *ngIf=\"formType === forms.MFA_SETUP\" \r\n    [qrCode]=\"qrCode\" \r\n    [code]  =\"code\" \r\n    [labels]=\"labels\" \r\n    [inputs]=\"inputs\" \r\n    [errors]=\"errors\" \r\n    (saveMfa)=\"relaySaveMfaKeyEvent($event)\">\r\n  </cal-mfa-setup-form>\r\n  <!-- NOTE: MFA Form -->\r\n  <cal-mfa-form *ngIf=\"formType === forms.MFA\" \r\n    [labels]=\"labels\" \r\n    [inputs]=\"inputs\" \r\n    [errors]=\"errors\" \r\n    (sendMfa)=\"relaySendMfaCodeEvent($event)\">\r\n  </cal-mfa-form>\r\n</mat-dialog-content>`,\r\n  styles: [`.header{color:#fff;background:#5eacff}`]\r\n})\r\nexport class ModalWrapperComponent implements OnInit, OnDestroy\r\n{\r\n  // NOTE: Useful for template\r\n  public forms = Forms;\r\n\r\n  // NOTE: Common\r\n  // Form type (password / mfa)\r\n  public formType        : string;\r\n  // Labels\r\n  public labels    : any;\r\n  // Errors\r\n  public errors    : any;\r\n  // Inputs\r\n  public inputs    : any;\r\n  // Event sent from modal\r\n  public closeSub        : Subscription;\r\n\r\n  // NOTE: Password\r\n  // First connection or Forgot password\r\n  public isFirst       : boolean;\r\n  // Password policies\r\n  public pwdPolicies   : any;\r\n  // Event sent from password form\r\n  public relayFirstLog : EventEmitter<any> = new EventEmitter();\r\n  public relayLostPwd  : EventEmitter<any> = new EventEmitter();\r\n\r\n  // NOTE: MFA setup\r\n  // MFA secret key\r\n  public code            : string;\r\n  public qrCode          : string;\r\n  // Event sent from mfa setup form\r\n  public relaySaveMfaKey : EventEmitter<any> = new EventEmitter();\r\n\r\n  // NOTE: MFA\r\n  // Event sent from mfa form\r\n  public relaySendMfaCode : EventEmitter<any> = new EventEmitter();\r\n\r\n  constructor\r\n  (\r\n    public  dialogRef : MatDialogRef<ModalWrapperComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: any\r\n  )\r\n  {\r\n    this.loadParams();\r\n  }\r\n\r\n  public ngOnInit() : void\r\n  {\r\n  }\r\n\r\n  public ngOnDestroy() : void\r\n  {\r\n    if(this.closeSub)\r\n      this.closeSub.unsubscribe();\r\n  }\r\n\r\n  public relayFirstLogEvent($event : any) : void\r\n  {\r\n    this.relayFirstLog.emit($event);\r\n  }\r\n\r\n  public relayLostPwdEvent($event : any) : void\r\n  {\r\n    this.relayLostPwd.emit($event);\r\n  }\r\n\r\n  public relaySaveMfaKeyEvent($event : any) : void\r\n  {\r\n    this.relaySaveMfaKey.emit($event);\r\n  }\r\n\r\n  public relaySendMfaCodeEvent($event : any) : void\r\n  {\r\n    this.relaySendMfaCode.emit($event);\r\n  }\r\n\r\n  private loadParams() : void\r\n  {\r\n    var data : any;\r\n    data = this.data;\r\n\r\n    if(data !== null)\r\n    {\r\n      this.formType       = data.formType;\r\n\r\n      // NOTE: Common\r\n      // Labels\r\n      this.labels         = data.labels;\r\n      // Labels\r\n      this.errors         = data.errors;\r\n      // Labels\r\n      this.inputs         = data.inputs;\r\n\r\n      // NOTE: Password\r\n      // First connection or Forgot password\r\n      this.isFirst        = data.isFirst;\r\n      // Password policies\r\n      this.pwdPolicies    = data.pwdPolicies;\r\n\r\n      // NOTE: MFA\r\n      // Mfa setupd codes\r\n      this.code           = data.code;\r\n      this.qrCode         = data.qrCode;\r\n\r\n      // Close dialog event\r\n      this.closeSub = data.closeEvent.subscribe((res) =>\r\n      {\r\n        this.dialogRef.close();\r\n      });\r\n    }\r\n  }\r\n\r\n}\r\n","// Angular modules\r\nimport { OnInit }          from '@angular/core';\r\nimport { AfterViewInit }   from '@angular/core';\r\nimport { OnChanges }       from '@angular/core';\r\nimport { SimpleChanges }   from '@angular/core';\r\nimport { OnDestroy }       from '@angular/core';\r\nimport { Input }           from '@angular/core';\r\nimport { Output }          from '@angular/core';\r\nimport { Component }       from '@angular/core';\r\nimport { EventEmitter }    from '@angular/core';\r\nimport { MatDialog }       from '@angular/material';\r\nimport { MatIconRegistry } from '@angular/material';\r\nimport { DomSanitizer }    from '@angular/platform-browser';\r\nimport { FormControl }     from '@angular/forms';\r\nimport { FormGroup }       from '@angular/forms';\r\nimport { FormBuilder }     from '@angular/forms';\r\nimport { Validators }      from '@angular/forms';\r\n\r\n// External modules\r\nimport { Subscription }    from 'rxjs/Subscription';\r\n\r\n// Internal modules\r\nimport { UsrValidator }    from './validators/usr.validator';\r\n\r\n// Enums\r\nimport { Layouts }         from './enums/layouts.enum';\r\nimport { Themes }          from './enums/themes.enum';\r\nimport { Forms }           from './enums/forms.enum';\r\nimport { UserPolicies }    from './enums/user-policies.enum';\r\n\r\n// Components\r\nimport { ModalWrapperComponent } from './layouts/modal-wrapper/modal-wrapper.component';\r\n\r\n@Component({\r\n  selector    : 'cal-login-form',\r\n  template: `<div class=\"{{ fixedWidth ? 'login-wrapper' : '' }}\" id=\"debug-login-form\">\r\n  <mat-tab-group id=\"caliatys-login-form\" [selectedIndex]=\"selectedTab\">\r\n    <mat-tab label=\"login-form\">\r\n      <!-- NOTE: Login form -->\r\n      <form (ngSubmit)=\"onClickLogin()\" [formGroup]=\"formGroup\" *ngIf=\"!googleStyle\">\r\n        <div class=\"row no-gutters\">\r\n          <div class=\"col\">\r\n            <div class=\"row no-gutters\">\r\n              <div class=\"col\">\r\n                <!-- NOTE: Username -->\r\n                <mat-form-field class=\"w-100\">\r\n                  <div matPrefix class=\"mr-2\" *ngIf=\"icons.iconUsrOnLoginForm\">\r\n                    <mat-icon class=\"align-bottom\">person</mat-icon>\r\n                  </div>\r\n                  <input matInput formControlName=\"username\" \r\n                    name=\"username\" autocomplete=\"username\" \r\n                    placeholder=\"{{ labels.input.username }}\" \r\n                    type=\"text\"/>\r\n                  <button *ngIf=\"formGroup.controls.username.value?.length > 0 && inputs.clearUsrOnLoginForm\" \r\n                    mat-button matSuffix mat-icon-button aria-label=\"Clear\" \r\n                    color=\"primary\" (click)=\"formGroup.controls.username.setValue('')\" \r\n                    [disabled]=\"formType === forms.MFA && formLayouts.mfa === layouts.INLINE ? true : false\" \r\n                    type=\"button\">\r\n                    <mat-icon>close</mat-icon>\r\n                  </button>\r\n                  <!-- NOTE: Error message(s) -->\r\n                  <mat-hint align=\"start\" *ngIf=\"formGroup.controls.username.errors?.required && errors.login\">\r\n                    {{ labels.policy.required }}\r\n                  </mat-hint>\r\n                  <mat-hint align=\"start\" *ngIf=\"formGroup.controls.username.errors?.pattern && errors.login && usrPolicy === userPolicies.EMAIL\">\r\n                    {{ labels.policy.email }}\r\n                  </mat-hint>\r\n                  <mat-hint align=\"start\" *ngIf=\"formGroup.controls.username.errors?.pattern && errors.login && usrPolicy === userPolicies.PHONE\">\r\n                    {{ labels.policy.phone }}\r\n                  </mat-hint>\r\n                  <mat-hint align=\"start\" *ngIf=\"formGroup.controls.username.errors?.pattern && errors.login && usrPolicy && usrPolicy !== userPolicies.EMAIL && usrPolicy !== userPolicies.PHONE\">\r\n                    {{ labels.policy.customRegex }}\r\n                  </mat-hint>\r\n                </mat-form-field>\r\n              </div>\r\n            </div>\r\n            <div class=\"row no-gutters\">\r\n              <div class=\"col\">\r\n                <!-- NOTE: Password -->\r\n                <mat-form-field class=\"w-100\">\r\n                  <div matPrefix class=\"mr-2\" *ngIf=\"icons.iconPwdOnLoginForm\">\r\n                    <mat-icon class=\"align-bottom\">lock</mat-icon>\r\n                  </div>\r\n                  <input matInput formControlName=\"password\" \r\n                    name=\"password\" autocomplete=\"password\" \r\n                    placeholder=\"{{ labels.input.password }}\" \r\n                    type=\"{{ showPassword ? 'text' : 'password' }}\"/>\r\n                  <button *ngIf=\"inputs.showPwdOnLoginForm\" \r\n                    mat-button matSuffix mat-icon-button aria-label=\"Clear\" \r\n                    color=\"primary\" (click)=\"showPassword=!showPassword\" \r\n                    [disabled]=\"formType === forms.MFA && formLayouts.mfa === layouts.INLINE ? true : false\" \r\n                    type=\"button\">\r\n                    <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>\r\n                  </button>\r\n                  <!-- NOTE: Error message -->\r\n                  <mat-hint align=\"start\" *ngIf=\"formGroup.controls.password.errors?.required && errors.login\">\r\n                    {{ labels.policy.required }}\r\n                  </mat-hint>\r\n                </mat-form-field>\r\n              </div> \r\n            </div>\r\n            <!-- NOTE: Buttons -->\r\n            <ng-container *ngIf=\"!( formType === forms.MFA && formLayouts.mfa === layouts.INLINE )\">\r\n              <div class=\"row no-gutters pb-3\">\r\n                <div class=\"col text-left\">\r\n                  <!-- TODO: Remember me -->\r\n                </div>\r\n                <!-- NOTE: Forgot password -->\r\n                <div class=\"col text-right\" *ngIf=\"buttons.forgotPassword\">\r\n                  <a (click)=\"onClickForgotPassword()\" href=\"#\" class=\"small\">\r\n                    {{ labels.button.forgotPassword }}\r\n                  </a>\r\n                </div>\r\n              </div>\r\n              <div class=\"row no-gutters pb-3\">\r\n                <div class=\"col text-right\">\r\n                  <!-- NOTE: Sign up -->\r\n                  <button mat-button (click)=\"onClickSignUp()\" type=\"button\" color=\"primary\" class=\"small text-uppercase mr-3\" *ngIf=\"buttons.signUp\">\r\n                    {{ labels.button.signUp }}\r\n                  </button>\r\n                  <!-- NOTE: Sign in -->\r\n                  <button mat-raised-button type=\"submit\" color=\"primary\" [disabled]=\"!formGroup.valid\" class=\"small text-uppercase\">\r\n                    {{ labels.button.signIn }}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </ng-container>\r\n          </div>\r\n        </div>\r\n      </form>\r\n      <!-- NOTE: Login by steps buttons -->\r\n      <div class=\"row no-gutters mb-3\" *ngIf=\"googleStyle\">\r\n        <div class=\"col text-right\" *ngIf=\"buttons.signUp\">\r\n          <!-- NOTE: Sign up -->\r\n          <button mat-button (click)=\"onClickSignUp()\" type=\"button\" color=\"primary\" class=\"small text-uppercase mr-2\">\r\n            {{ labels.button.signUp }}\r\n          </button>\r\n        </div>\r\n        <div class=\"col {{ buttons.signUp ? 'text-left' : 'text-center'}}\">\r\n          <!-- NOTE: Sign in -->\r\n          <button mat-raised-button (click)=\"onClickNextStep(0)\" type=\"button\" color=\"primary\" class=\"small text-uppercase ml-2\">\r\n            {{ labels.button.signIn }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n      <!-- NOTE: Social buttons -->\r\n      <ng-container *ngIf=\"!( formType === forms.MFA && formLayouts.mfa === layouts.INLINE )\">\r\n        <div class=\"row no-gutters\">\r\n          <div class=\"col text-center\">\r\n            <!-- NOTE: Google -->\r\n            <div class=\"d-block mb-3\" *ngIf=\"buttons.google\">\r\n              <button mat-raised-button type=\"button\" class=\"mat-raised-button cal-btn google {{ theme }}\" (click)=\"onClickLoginSocial('google')\">\r\n                <span class=\"cal-bg-icon\">\r\n                  <mat-icon class=\"align-middle cal-icon\" svgIcon=\"google\"></mat-icon>\r\n                </span>\r\n                <span class=\"cal-label\">{{ labels.button.googleSignIn }}</span>\r\n              </button>\r\n            </div>\r\n            <!-- NOTE: Facebook -->\r\n            <div class=\"d-block mb-3\" *ngIf=\"buttons.facebook\">\r\n              <button mat-raised-button type=\"button\" class=\"cal-btn facebook\" (click)=\"onClickLoginSocial('facebook')\">\r\n                <span class=\"cal-bg-icon\">\r\n                  <mat-icon class=\"align-middle cal-icon\" svgIcon=\"facebook\"></mat-icon>\r\n                </span>\r\n                <span class=\"cal-label\">{{ labels.button.facebookSignIn }}</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </ng-container>\r\n      <!-- NOTE: Inline MFA -->\r\n      <ng-container *ngIf=\"formType === forms.MFA && formLayouts.mfa === layouts.INLINE\">\r\n        <div class=\"row no-gutters\">\r\n          <div class=\"col\">\r\n            <cal-mfa-form \r\n              [inputs]=\"inputs\" \r\n              [labels]=\"labels\" \r\n              [errors]=\"errors\" \r\n              (sendMfa)=\"tabSendMfaCode($event)\">\r\n            </cal-mfa-form>\r\n          </div>\r\n        </div>\r\n      </ng-container>\r\n    </mat-tab>\r\n    <mat-tab label=\"usr-step\" *ngIf=\"googleStyle\">\r\n      <!-- NOTE: Back button -->\r\n      <div class=\"row no-gutters mb-3\">\r\n        <div class=\"col\">\r\n          <a href=\"#\" (click)=\"onClickPrevStep(1)\" title=\"{{ labels.button.back }}\">\r\n            <mat-icon class=\"align-bottom mr-2\">keyboard_arrow_left</mat-icon>{{ labels.button.back }}\r\n          </a>\r\n        </div>\r\n      </div>\r\n      <form (ngSubmit)=\"onClickNextStep(1)\" [formGroup]=\"usrFormGroup\">\r\n        <!-- NOTE: Username -->\r\n        <mat-form-field class=\"w-100\">\r\n          <div matPrefix class=\"mr-2\" *ngIf=\"icons.iconUsrOnLoginForm\">\r\n            <mat-icon class=\"align-bottom\">person</mat-icon>\r\n          </div>\r\n          <input matInput formControlName=\"username\" \r\n            name=\"username\" autocomplete=\"username\" \r\n            placeholder=\"{{ labels.input.username }}\" \r\n            type=\"text\"/>\r\n          <button *ngIf=\"usrFormGroup.controls.username.value?.length > 0 && inputs.clearUsrOnLoginForm\" \r\n            mat-button matSuffix mat-icon-button aria-label=\"Clear\" \r\n            color=\"primary\" (click)=\"usrFormGroup.controls.username.setValue('')\" \r\n            [disabled]=\"formType === forms.MFA && formLayouts.mfa === layouts.INLINE ? true : false\" \r\n            type=\"button\">\r\n            <mat-icon>close</mat-icon>\r\n          </button>\r\n          <!-- NOTE: Error message(s) -->\r\n          <mat-hint align=\"start\" *ngIf=\"usrFormGroup.controls.username.errors?.required && errors.login\">\r\n            {{ labels.policy.required }}\r\n          </mat-hint>\r\n          <mat-hint align=\"start\" *ngIf=\"usrFormGroup.controls.username.errors?.pattern && errors.login && usrPolicy === userPolicies.EMAIL\">\r\n            {{ labels.policy.email }}\r\n          </mat-hint>\r\n          <mat-hint align=\"start\" *ngIf=\"usrFormGroup.controls.username.errors?.pattern && errors.login && usrPolicy === userPolicies.PHONE\">\r\n            {{ labels.policy.phone }}\r\n          </mat-hint>\r\n          <mat-hint align=\"start\" *ngIf=\"usrFormGroup.controls.username.errors?.pattern && errors.login && usrPolicy && usrPolicy !== userPolicies.EMAIL && usrPolicy !== userPolicies.PHONE\">\r\n            {{ labels.policy.customRegex }}\r\n          </mat-hint>\r\n        </mat-form-field>\r\n        <div class=\"row no-gutters mb-3\">\r\n          <!-- NOTE: Forgot password -->\r\n          <div class=\"col text-left\" *ngIf=\"buttons.forgotPassword\">\r\n            <a (click)=\"onClickForgotPassword()\" href=\"#\" class=\"small\">\r\n              {{ labels.button.forgotPassword }}\r\n            </a>\r\n          </div>\r\n          <!-- NOTE: Next button -->\r\n          <div class=\"col text-right\">\r\n            <button mat-raised-button type=\"submit\" color=\"primary\" [disabled]=\"!usrFormGroup.valid\" class=\"small text-uppercase\">\r\n              {{ labels.button.next }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </mat-tab>\r\n    <mat-tab label=\"pwd-step\" *ngIf=\"googleStyle\">\r\n      <!-- NOTE: Back button -->\r\n      <div class=\"row no-gutters mb-3\">\r\n        <div class=\"col\">\r\n          <a href=\"#\" (click)=\"onClickPrevStep(2)\" title=\"{{ labels.button.back }}\">\r\n            <mat-icon class=\"align-bottom mr-2\">keyboard_arrow_left</mat-icon>{{ labels.button.back }}\r\n          </a>\r\n        </div>\r\n      </div>\r\n      <!-- TODO: User info -->\r\n      <p>{{ userInfo }}</p>\r\n      <form (ngSubmit)=\"onClickNextStep(2)\" [formGroup]=\"pwdFormGroup\">\r\n        <!-- NOTE: Password -->\r\n        <mat-form-field class=\"w-100\">\r\n          <div matPrefix class=\"mr-2\" *ngIf=\"icons.iconPwdOnLoginForm\">\r\n            <mat-icon class=\"align-bottom\">lock</mat-icon>\r\n          </div>\r\n          <input matInput formControlName=\"password\" \r\n            name=\"password\" autocomplete=\"password\" \r\n            placeholder=\"{{ labels.input.password }}\" \r\n            type=\"{{ showPassword ? 'text' : 'password' }}\"/>\r\n          <button *ngIf=\"inputs.showPwdOnLoginForm\" \r\n            mat-button matSuffix mat-icon-button aria-label=\"Clear\" \r\n            color=\"primary\" (click)=\"showPassword=!showPassword\" \r\n            [disabled]=\"formType === forms.MFA && formLayouts.mfa === layouts.INLINE ? true : false\" \r\n            type=\"button\">\r\n            <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>\r\n          </button>\r\n          <!-- NOTE: Error message -->\r\n          <mat-hint align=\"start\" *ngIf=\"pwdFormGroup.controls.password.errors?.required && errors.login\">\r\n            {{ labels.policy.required }}\r\n          </mat-hint>\r\n        </mat-form-field>\r\n        <!-- NOTE: Next button -->\r\n        <div class=\"row no-gutters mb-3\">\r\n          <div class=\"col text-right\">\r\n            <button mat-raised-button type=\"submit\" color=\"primary\" [disabled]=\"!pwdFormGroup.valid\" class=\"small text-uppercase\">\r\n              {{ labels.button.next }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </mat-tab>\r\n    <mat-tab label=\"tab-wrapper\" *ngIf=\"(formLayouts | existsLayout: layouts.TAB)\">\r\n      <!-- NOTE: Tab form -->\r\n      <cal-tab-wrapper \r\n        [formType]=\"formType\" \r\n        [isFirst]=\"isFirst\" \r\n        [code]   =\"code\" \r\n        [qrCode] =\"qrCode\" \r\n        [pwdPolicies]=\"pwdPolicies\" \r\n        [errors]=\"errors\" \r\n        [labels]=\"labels\" \r\n        [inputs]=\"inputs\" \r\n        (sendCloseTab)=\"onClickCloseTab($event)\" \r\n        (relayFirstLog)=\"tabFirstLog($event)\" \r\n        (relayLostPwd)=\"tabLostPwd($event)\" \r\n        (relaySaveMfaKey)=\"tabSaveMfaKey($event)\" \r\n        (relaySendMfaCode)=\"tabSendMfaCode($event)\">\r\n      </cal-tab-wrapper>\r\n    </mat-tab>\r\n  </mat-tab-group>\r\n</div>`,\r\n  styles: [`/deep/ #caliatys-login-form mat-tab-header{display:none!important}mat-form-field mat-icon{color:grey}.login-wrapper{width:100%;max-width:330px;padding:15px;margin:0 auto}.cal-btn{line-height:35px;border:0!important;padding:1px!important}.cal-btn .cal-bg-icon{padding:8px;width:34px;height:34px;display:inline-block;vertical-align:top!important}.cal-btn .cal-bg-icon .cal-icon{display:inline-block;height:18px;width:18px;margin-top:-4px;vertical-align:top!important}.cal-btn .cal-label{padding-right:8px;padding-left:16px;size:14px;font-family:Roboto,sans-serif}.adn{background-color:#d87a68!important;color:#fff!important}.adn i{color:#fff!important}.adn:hover{background-color:#e29e91!important}.bitbucket{background-color:#205081!important;color:#fff!important}.bitbucket i{color:#fff!important}.bitbucket:hover{background-color:#2a69aa!important}.dropbox{background-color:#1087dd!important;color:#fff!important}.dropbox i{color:#fff!important}.dropbox:hover{background-color:#309ff0!important}.facebook{background-color:#3b5998!important;color:#fff!important}.facebook i{color:#fff!important}.facebook:hover{background-color:#4c70ba!important}.flickr{background-color:#ff0084!important;color:#fff!important}.flickr i{color:#fff!important}.flickr:hover{background-color:#ff339d!important}.foursquare{background-color:#f94877!important;color:#fff!important}.foursquare i{color:#fff!important}.foursquare:hover{background-color:#fb799c!important}.github{background-color:#444!important;color:#fff!important}.github i{color:#fff!important}.github:hover{background-color:#5e5e5e!important}.instagram{background-color:#405de6!important;color:#fff!important}.instagram i{color:#fff!important}.instagram:hover{background-color:#6d83ec!important}.linkedin{background-color:#007bb6!important;color:#fff!important}.linkedin i{color:#fff!important}.linkedin:hover{background-color:#009de9!important}.microsoft{background-color:#2672ec!important;color:#fff!important}.microsoft i{color:#fff!important}.microsoft:hover{background-color:#5590f0!important}.windows{background-color:#2672ec!important;color:#fff!important}.windows i{color:#fff!important}.windows:hover{background-color:#5590f0!important}.odnoklassniki{background-color:#f4731c!important;color:#fff!important}.odnoklassniki i{color:#fff!important}.odnoklassniki:hover{background-color:#f6914d!important}.openid{background-color:#f7931e!important;color:#fff!important}.openid i{color:#fff!important}.openid:hover{background-color:#f9ab4f!important}.pinterest{background-color:#cb2027!important;color:#fff!important}.pinterest i{color:#fff!important}.pinterest:hover{background-color:#e03e44!important}.reddit{background-color:#eff7ff!important;color:#000!important}.reddit i{color:#000!important}.reddit:hover{background-color:#fff!important}.soundcloud{background-color:#f50!important;color:#fff!important}.soundcloud i{color:#fff!important}.soundcloud:hover{background-color:#f73!important}.tumblr{background-color:#2c4762!important;color:#fff!important}.tumblr i{color:#fff!important}.tumblr:hover{background-color:#3c6185!important}.twitter{background-color:#55acee!important;color:#fff!important}.twitter i{color:#fff!important}.twitter:hover{background-color:#83c3f3!important}.vimeo{background-color:#1ab7ea!important;color:#fff!important}.vimeo i{color:#fff!important}.vimeo:hover{background-color:#49c6ee!important}.vk{background-color:#587ea3!important;color:#fff!important}.vk i{color:#fff!important}.vk:hover{background-color:#7897b6!important}.yahoo{background-color:#720e9e!important;color:#fff!important}.yahoo i{color:#fff!important}.yahoo:hover{background-color:#9412cd!important}.google.light{background-color:#fff!important;color:#5f6368!important}.google.light i{color:#5f6368!important}.google.light:hover{background-color:#fff!important}.google.dark{background-color:#4285f4!important;color:#fff!important}.google.dark i{color:#fff!important}.google.dark:hover{background-color:#72a4f7!important}.google.dark .cal-bg-icon{background:#fff}`]\r\n})\r\nexport class LoginFormComponent implements OnInit, OnChanges, AfterViewInit, OnDestroy\r\n{\r\n  public    formLayouts    : any;\r\n  public    theme          : string;\r\n\r\n  public    usrPolicy      : string;\r\n  public    pwdPolicies    : any;\r\n\r\n  public    icons          : any;\r\n  public    buttons        : any;\r\n  public    inputs         : any;\r\n  public    errors         : any;\r\n  public    labels         : any;\r\n\r\n  // Display login form inside a container\r\n  @Input()  fixedWidth        : boolean = false;\r\n  // Display login form like Google & Microsoft (step by step)\r\n  @Input()  googleStyle       : boolean = false;\r\n  // Display Google button with the supplied theme : light / dark\r\n  @Input()  googleTheme       : string  = null;\r\n  // Display forms inside a layout : tab (by default) / modal / inline\r\n  // The inline layout is only available for the MFA form\r\n  @Input()  customFormLayouts : any;\r\n\r\n  // Optional policy applied on the username input : email / phone / regex\r\n  // Be careful, you must double all the backslashes used in the supplied regex\r\n  @Input()  customUsrPolicy   : string = null;\r\n  // Policies applied on the password input\r\n  @Input()  customPwdPolicies : any;\r\n\r\n  // Dislay icon inside inputs on the login form\r\n  @Input()  customIcons   : any;\r\n\r\n  // Display buttons with events\r\n  @Input()  customButtons : any;\r\n\r\n  // Display clear & show/hide buttons inside inputs\r\n  @Input()  customInputs  : any;\r\n\r\n  // Display error messages\r\n  @Input()  customErrors  : any;\r\n\r\n  // Labels\r\n  @Input()  customLabels  : any;\r\n\r\n  // Event triggered after creating the login form (AfterViewInit)\r\n  @Output() initialized   : EventEmitter<any> = new EventEmitter();\r\n  // Event triggered after clicking on the sign up button.\r\n  @Output() signUp        : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing username and password properties\r\n  @Output() login         : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing username, password and social properties\r\n  @Output() loginSocial   : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing username property\r\n  @Output() forgotPwd     : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing password and code properties\r\n  @Output() sendResetPwd  : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing password property\r\n  @Output() sendFirstPwd  : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing code property\r\n  @Output() saveMfaKey    : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing code property\r\n  @Output() sendMfaCode   : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing username property\r\n  @Output() stepUsr       : EventEmitter<any> = new EventEmitter();\r\n  // Event object containing username and password property\r\n  @Output() stepPwd       : EventEmitter<any> = new EventEmitter();\r\n\r\n  // NOTE: Form\r\n  public    formGroup     : FormGroup;\r\n  public    showPassword  : boolean = false;\r\n  public    formType      : string;\r\n  public    userPolicies = UserPolicies;\r\n  public    forms = Forms;\r\n\r\n  // NOTE: Password\r\n  public    isFirst       : boolean = false;\r\n\r\n  // NOTE: MFA\r\n  public    code          : string  = null;\r\n  public    qrCode        : string  = null;\r\n\r\n  // NOTE: Steps\r\n  public    usrFormGroup  : FormGroup;\r\n  public    pwdFormGroup  : FormGroup;\r\n  public    userInfo      : string  = null;\r\n  public    userImage     : string  = null;\r\n\r\n  // NOTE: Wrapper\r\n  public    layouts = Layouts;\r\n  public    selectedTab     : number = 0;\r\n  public    closeModalEvent : EventEmitter<boolean> = new EventEmitter();\r\n\r\n  private   modalFirstSub       : Subscription;\r\n  private   modalLostSub        : Subscription;\r\n  private   modalSaveMfaKeySub  : Subscription;\r\n  private   modalSendMfaCodeSub : Subscription;\r\n\r\n  // TODO: Captcha\r\n  // @Input()  rememberMe    : boolean = true; // TODO: check box\r\n\r\n  constructor\r\n  (\r\n    public  dialog       : MatDialog,\r\n    public  sanitizer    : DomSanitizer,\r\n    public  iconRegistry : MatIconRegistry,\r\n    private builder      : FormBuilder\r\n  )\r\n  {\r\n    // Social icons\r\n    // TODO: Fix Angular 6 Library assets : https://github.com/angular/angular-cli/issues/11071\r\n    iconRegistry.addSvgIcon('google',   sanitizer.bypassSecurityTrustResourceUrl('../assets/img/google.svg'));\r\n    iconRegistry.addSvgIcon('facebook', sanitizer.bypassSecurityTrustResourceUrl('../assets/img/facebook.svg'));\r\n  }\r\n\r\n  public ngOnInit() : void\r\n  {\r\n    // Login form\r\n    this.initFormGroups();\r\n    // Style (container, step, theme & layout)\r\n    this.initFormLayouts();\r\n    this.initTheme();\r\n\r\n    this.initPolicies();\r\n    this.initIcons();\r\n    this.initButtons();\r\n    this.initInputs();\r\n    this.initErrors();\r\n    this.initLabels();\r\n  }\r\n\r\n  public ngAfterViewInit() : void\r\n  {\r\n    this.initialized.emit();\r\n  }\r\n\r\n  public ngOnChanges(changes : SimpleChanges) : void\r\n  {\r\n    if(changes.googleStyle)\r\n      this.initFormGroups();\r\n    if(changes.customFormLayouts)\r\n      this.initFormLayouts();\r\n    if(changes.googleTheme)\r\n      this.initTheme();\r\n\r\n    if(changes.customPwdPolicies || changes.customUsrPolicy)\r\n      this.initPolicies();\r\n    if(changes.customIcons)\r\n      this.initIcons();\r\n    if(changes.customButtons)\r\n      this.initButtons();\r\n    if(changes.customInputs)\r\n      this.initInputs();\r\n    if(changes.customErrors)\r\n      this.initErrors();\r\n    if(changes.customLabels)\r\n      this.initLabels();\r\n  }\r\n\r\n  public ngOnDestroy() : void\r\n  {\r\n    if(this.modalFirstSub)\r\n      this.modalFirstSub.unsubscribe();\r\n    if(this.modalLostSub)\r\n      this.modalLostSub.unsubscribe();\r\n    if(this.modalSaveMfaKeySub)\r\n      this.modalSaveMfaKeySub.unsubscribe();\r\n    if(this.modalSendMfaCodeSub)\r\n      this.modalSendMfaCodeSub.unsubscribe();\r\n  }\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  // NOTE: Event -------------------------------------------------------------------------------\r\n  // -------------------------------------------------------------------------------------------\r\n\r\n  // NOTE: From component to user --------------------------------------------------------------\r\n\r\n  /** Emit `$event` object containing username and password properties.\r\n  *\r\n  * @example\r\n  * var username : string = $event.username;\r\n  * var password : string = $event.password;\r\n  */\r\n  public onClickLogin() : void\r\n  {\r\n    let event : any = {};\r\n    event = this.getEventResponse();\r\n    this.login.emit(event);\r\n  }\r\n\r\n  /** Emit `$event` object containing username, password and social properties.\r\n  *\r\n  * @param social Name of the social provider\r\n  * @example\r\n  * var username : string = $event.username;\r\n  * var password : string = $event.password;\r\n  * var social   : string = $event.social;\r\n  */\r\n  public onClickLoginSocial(social : string) : void\r\n  {\r\n    let event : any = {};\r\n    event = this.getEventResponse();\r\n    event.social = social;\r\n    this.loginSocial.emit(event);\r\n  }\r\n\r\n  /** Emit a click event on the sign up button. */\r\n  public onClickSignUp() : void\r\n  {\r\n    this.signUp.emit();\r\n  }\r\n\r\n  /** Emit `$event` object containing username property.\r\n  *\r\n  * @example\r\n  * var username : string = $event.username;\r\n  */\r\n  public onClickForgotPassword() : void\r\n  {\r\n    let event : any = {};\r\n    event = this.getEventResponse('usr');\r\n    this.forgotPwd.emit(event);\r\n  }\r\n\r\n  // NOTE: From user to component --------------------------------------------------------------\r\n\r\n  /** Show password form either to initialize first password or to reset forgot password.\r\n  *\r\n  * @param isFirst Initialize first password or reset forgot password\r\n  */\r\n  public showPwdForm(isFirst : boolean) : void\r\n  {\r\n    this.isFirst  = isFirst;\r\n    this.formType = Forms.PWD;\r\n    this.showLayout(this.formLayouts.pwd);\r\n  }\r\n\r\n  /** Show MFA setup form to initialize first TOTP (Time-based One-time Password).\r\n  *\r\n  * @param code   \r\n  * @param qrCode \r\n  */\r\n  public showMfaSetupForm(code : string, qrCode : string) : void\r\n  {\r\n    this.code     = code;\r\n    this.qrCode   = qrCode;\r\n    this.formType = Forms.MFA_SETUP;\r\n    this.showLayout(this.formLayouts.mfaSetup);\r\n  }\r\n\r\n  /** Show MFA form to get verification code. */\r\n  public showMfaForm() : void\r\n  {\r\n    this.formType = Forms.MFA;\r\n    this.showLayout(this.formLayouts.mfa);\r\n  }\r\n\r\n  /** Hide password form. */\r\n  public hidePwdForm() : void\r\n  {\r\n    this.closeLayout(this.formLayouts.password);\r\n  }\r\n\r\n  /** Hide MFA setup form. */\r\n  public hideMfaSetupForm() : void\r\n  {\r\n    this.closeLayout(this.formLayouts.mfaSetup);\r\n  }\r\n\r\n  /** Hide MFA form. */\r\n  public hideMfaForm() : void\r\n  {\r\n    this.closeLayout(this.formLayouts.mfa);\r\n  }\r\n\r\n  /** Go password step. */\r\n  public showPwdStep(userInfo : string = null, userImage : string = null) : void\r\n  {\r\n    this.userInfo    = userInfo;\r\n    this.userImage   = userImage;\r\n    this.selectedTab = 2;\r\n  }\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  // NOTE: Steps events ------------------------------------------------------------------------\r\n  // -------------------------------------------------------------------------------------------\r\n\r\n  public onClickNextStep(currentStep : number) : void\r\n  {\r\n    switch(currentStep)\r\n    {\r\n      case 0 :\r\n        this.selectedTab = 1;\r\n        break;\r\n      case 1 : // Username\r\n        let eventUsr : any = null;\r\n        eventUsr = this.getEventResponse('usr');\r\n        this.stepUsr.emit(eventUsr);\r\n        break;\r\n      case 2 : // Password\r\n        let eventPwd : any = null;\r\n        eventPwd = this.getEventResponse();\r\n        this.stepPwd.emit(eventPwd);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  public onClickPrevStep(currentStep : number) : void\r\n  {\r\n    switch(currentStep)\r\n    {\r\n      case 0 :\r\n        break;\r\n      case 1 : // Username\r\n        this.selectedTab = 0;\r\n        break;\r\n      case 2 : // Password\r\n        this.selectedTab = 1;\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  // NOTE: Tab events --------------------------------------------------------------------------\r\n  // -------------------------------------------------------------------------------------------\r\n\r\n  /** Emit `$event` object containing password property.\r\n  *\r\n  * @example\r\n  * var newPassword : string = $event.password;\r\n  */\r\n  public tabFirstLog($event : any) : void\r\n  {\r\n    this.sendFirstPwd.emit($event);\r\n  }\r\n\r\n  /** Emit `$event` object containing password and code properties.\r\n  *\r\n  * @example\r\n  * var newPassword      : string = $event.password;\r\n  * var verificationCode : string = $event.code;\r\n  */\r\n  public tabLostPwd($event : any) : void\r\n  {\r\n    this.sendResetPwd.emit($event);\r\n  }\r\n\r\n  /** Emit `$event` object containing code property.\r\n  *\r\n  * @example\r\n  * var verificationCode : string = $event.code;\r\n  */\r\n  public tabSaveMfaKey($event : any) : void\r\n  {\r\n    this.saveMfaKey.emit($event);\r\n  }\r\n\r\n  /** Emit `$event` object containing code property.\r\n  *\r\n  * @example\r\n  * var verificationCode : string = $event.code;\r\n  */\r\n  public tabSendMfaCode($event : any) : void\r\n  {\r\n    this.sendMfaCode.emit($event);\r\n  }\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  // NOTE: Modal events ------------------------------------------------------------------------\r\n  // -------------------------------------------------------------------------------------------\r\n\r\n  /** Emit `$event` object containing password property.\r\n  *\r\n  * @example\r\n  * var newPassword : string = $event.password;\r\n  */\r\n  public modalFirstLog(dialogRef : any) : void\r\n  {\r\n    this.modalFirstSub = dialogRef.componentInstance.relayFirstLog.subscribe((event) =>\r\n    {\r\n      this.sendFirstPwd.emit(event);\r\n    });\r\n  }\r\n\r\n  /** Emit `$event` object containing password and code properties.\r\n  *\r\n  * @example\r\n  * var newPassword      : string = $event.password;\r\n  * var verificationCode : string = $event.code;\r\n  */\r\n  public modalLostPwd(dialogRef : any) : void\r\n  {\r\n    this.modalLostSub = dialogRef.componentInstance.relayLostPwd.subscribe((event) =>\r\n    {\r\n      this.sendResetPwd.emit(event);\r\n    });\r\n  }\r\n\r\n  /** Emit `$event` object containing code property.\r\n  *\r\n  * @example\r\n  * var verificationCode : string = $event.code;\r\n  */\r\n  public modalSaveMfaKey(dialogRef : any) : void\r\n  {\r\n    this.modalSaveMfaKeySub = dialogRef.componentInstance.relaySaveMfaKey.subscribe((event) =>\r\n    {\r\n      this.saveMfaKey.emit(event);\r\n    });\r\n  }\r\n\r\n  /** Emit `$event` object containing code property.\r\n  *\r\n  * @example\r\n  * var verificationCode : string = $event.code;\r\n  */\r\n  public modalSendMfaCode(dialogRef : any) : void\r\n  {\r\n    this.modalSendMfaCodeSub = dialogRef.componentInstance.relaySendMfaCode.subscribe((event) =>\r\n    {\r\n      this.sendMfaCode.emit(event);\r\n    });\r\n  }\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  // NOTE: Tab ---------------------------------------------------------------------------------\r\n  // -------------------------------------------------------------------------------------------\r\n\r\n  public onClickCloseTab($event : any) : void\r\n  {\r\n    this.closeTab();\r\n  }\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  // NOTE: Modal -------------------------------------------------------------------------------\r\n  // -------------------------------------------------------------------------------------------\r\n\r\n  private openModal() : void\r\n  {\r\n    let params : any = {\r\n      // Common\r\n      formType              : this.formType,\r\n      labels                : this.labels,\r\n      closeEvent            : this.closeModalEvent,\r\n      errors                : this.errors,\r\n      inputs                : this.inputs,\r\n      // Password form\r\n      isFirst               : this.isFirst,\r\n      pwdPolicies           : this.pwdPolicies,\r\n      // Mfa form\r\n      code                  : this.code,\r\n      qrCode                : this.qrCode\r\n    };\r\n\r\n    let dialogRef = this.dialog.open(ModalWrapperComponent, { data : params });\r\n\r\n    if(this.formType === Forms.PWD)\r\n    {\r\n      this.modalFirstLog(dialogRef);\r\n      this.modalLostPwd(dialogRef);\r\n    }\r\n\r\n    if(this.formType === Forms.MFA_SETUP)\r\n      this.modalSaveMfaKey(dialogRef);\r\n\r\n    if(this.formType === Forms.MFA)\r\n      this.modalSendMfaCode(dialogRef);\r\n\r\n    dialogRef.afterClosed().subscribe(result =>\r\n    {\r\n      this.formType = null;\r\n      if(result)\r\n        this.formGroup.controls.password.setValue(result); // Set password\r\n    });\r\n  }\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  // NOTE: Private -----------------------------------------------------------------------------\r\n  // -------------------------------------------------------------------------------------------\r\n\r\n  private showLayout(formLayout : string) : void\r\n  {\r\n    switch(formLayout)\r\n    {\r\n      case Layouts.TAB    :\r\n        this.openTab();\r\n        break;\r\n      case Layouts.MODAL  :\r\n        this.openModal();\r\n        break;\r\n      case Layouts.INLINE :\r\n        this.formGroup.controls.username.disable();\r\n        this.formGroup.controls.password.disable();\r\n        break;\r\n      default :\r\n        this.openTab();\r\n        break;\r\n    }\r\n  }\r\n\r\n  private closeLayout(formLayout : string) : void\r\n  {\r\n    this.formType = null;\r\n\r\n    switch(formLayout)\r\n    {\r\n      case Layouts.TAB    :\r\n        this.closeTab();\r\n        break;\r\n      case Layouts.MODAL  :\r\n        this.closeModal();\r\n        break;\r\n      case Layouts.INLINE :\r\n        this.formGroup.controls.username.enable();\r\n        this.formGroup.controls.password.enable();\r\n        break;\r\n      default :\r\n        this.closeTab();\r\n        break;\r\n    }\r\n  }\r\n\r\n  private closeModal() : void\r\n  {\r\n    this.closeModalEvent.emit();\r\n  }\r\n\r\n  private openTab() : void\r\n  {\r\n    if(this.googleStyle)\r\n      this.selectedTab = 3;\r\n    else\r\n      this.selectedTab = 1;\r\n  }\r\n\r\n  private closeTab() : void\r\n  {\r\n    this.selectedTab = 0;\r\n  }\r\n\r\n  private getEventResponse(onlyOne : string = null) : any\r\n  {\r\n    let event    : any    = {};\r\n    let username : string = null;\r\n    let password : string = null;\r\n\r\n    if(this.googleStyle)\r\n    {\r\n      username = this.usrFormGroup.controls.username.value;\r\n      password = this.pwdFormGroup.controls.password.value;\r\n    }\r\n    else\r\n    {\r\n      username = this.formGroup.controls.username.value;\r\n      password = this.formGroup.controls.password.value;\r\n    }\r\n\r\n    if(!onlyOne)\r\n    {\r\n      event.username = username;\r\n      event.password = password;\r\n    }\r\n    if(onlyOne && onlyOne === 'usr')\r\n      event.username = username;\r\n    if(onlyOne && onlyOne === 'pwd')\r\n      event.password = password;\r\n\r\n    return event;\r\n  }\r\n\r\n  // -------------------------------------------------------------------------------------------\r\n  // NOTE: Init --------------------------------------------------------------------------------\r\n  // -------------------------------------------------------------------------------------------\r\n\r\n  private initFormLayouts() : void\r\n  {\r\n    let defaultFormLayouts : any = null;\r\n    let formLayouts        : any = null;\r\n\r\n    // Form layouts\r\n    defaultFormLayouts = {\r\n      pwd      : Layouts.TAB,\r\n      mfaSetup : Layouts.TAB,\r\n      mfa      : Layouts.TAB,\r\n    };\r\n\r\n    formLayouts = Object.assign(defaultFormLayouts, this.customFormLayouts);\r\n\r\n    // Corrections\r\n    if(formLayouts.pwd === Layouts.INLINE)\r\n      formLayouts.pwd = Layouts.TAB;\r\n    if(formLayouts.mfaSetup === Layouts.INLINE)\r\n      formLayouts.mfaSetup = Layouts.TAB;\r\n    if(this.googleStyle && formLayouts.mfa === Layouts.INLINE)\r\n      formLayouts.mfa = Layouts.TAB;\r\n\r\n    this.formLayouts = formLayouts;\r\n  }\r\n\r\n  private initTheme() : void\r\n  {\r\n    let theme : string = null;\r\n\r\n    // Theme\r\n    switch(this.googleTheme)\r\n    {\r\n      case Themes.LIGHT :\r\n        theme = this.googleTheme;\r\n        break;\r\n      case Themes.DARK :\r\n        theme = this.googleTheme;\r\n        break;\r\n      default :\r\n        theme = Themes.LIGHT;\r\n        break;\r\n    }\r\n\r\n    this.theme = theme;\r\n  }\r\n\r\n  private initIcons() : void\r\n  {\r\n    let defaultIcons : any = null;\r\n    let icons        : any = null;\r\n\r\n    // Icons\r\n    defaultIcons = {\r\n      iconUsrOnLoginForm : true,\r\n      iconPwdOnLoginForm : true,\r\n    };\r\n\r\n    icons = Object.assign(defaultIcons, this.customIcons);\r\n    this.icons = icons;\r\n  }\r\n\r\n  private initButtons() : void\r\n  {\r\n    let defaultButons : any = null;\r\n    let buttons       : any = null;\r\n\r\n    // Buttons\r\n    defaultButons = {\r\n      forgotPassword : true,\r\n      signUp         : true,\r\n      google         : true,\r\n      facebook       : true\r\n    };\r\n\r\n    buttons = Object.assign(defaultButons, this.customButtons);\r\n    this.buttons = buttons;\r\n  }\r\n\r\n  private initInputs() : void\r\n  {\r\n    let defaultInputs : any = null;\r\n    let inputs        : any = null;\r\n\r\n    // Inputs\r\n    defaultInputs = {\r\n      clearUsrOnLoginForm : true,\r\n      showPwdOnLoginForm  : true,\r\n      showPwdOnPwdForm    : true,\r\n      clearCodeOnPwdForm  : true,\r\n      clearCodeOnMfaForm  : true\r\n    };\r\n\r\n    inputs = Object.assign(defaultInputs, this.customInputs);\r\n    this.inputs = inputs;\r\n  }\r\n\r\n  private initErrors() : void\r\n  {\r\n    let defaultErrors : any = null;\r\n    let errors        : any = null;\r\n\r\n    // Errors\r\n    defaultErrors = {\r\n      login : true,\r\n      pwd   : true,\r\n      mfa   : true\r\n    };\r\n\r\n    errors = Object.assign(defaultErrors, this.customErrors);\r\n    this.errors = errors;\r\n  }\r\n\r\n  private initPolicies() : void\r\n  {\r\n    // NOTE: Password\r\n    let defaultPwdPolicies : any    = null;\r\n    let pwdPolicies        : any    = null;\r\n    let defaultMin         : number = 8;\r\n    let defaultMax         : number = 128;\r\n\r\n    // Password policies\r\n    defaultPwdPolicies = {\r\n      range : {\r\n        min : defaultMin,\r\n        max : defaultMax,\r\n      },\r\n      char   : true,\r\n      number : true,\r\n      lower  : true,\r\n      upper  : true\r\n    };\r\n\r\n    pwdPolicies = Object.assign(defaultPwdPolicies, this.customPwdPolicies);\r\n\r\n    if(pwdPolicies.range.min > pwdPolicies.range.max)\r\n    {\r\n      pwdPolicies.range.min = defaultMin;\r\n      pwdPolicies.range.max = defaultMax;\r\n    }\r\n\r\n    this.pwdPolicies = pwdPolicies;\r\n\r\n    // NOTE: Username\r\n    if(!this.customUsrPolicy)\r\n      return;\r\n\r\n    let validators : any = [];\r\n\r\n    switch(this.customUsrPolicy)\r\n    {\r\n      case UserPolicies.EMAIL :\r\n        validators.push(UsrValidator.email);\r\n        break;\r\n      case UserPolicies.PHONE :\r\n        validators.push(UsrValidator.phone);\r\n        break;\r\n      default :\r\n        let regExp : RegExp = null;\r\n        regExp = new RegExp(this.customUsrPolicy);\r\n        validators.push(UsrValidator.custom(regExp));\r\n        break;\r\n    }\r\n\r\n    validators.push(Validators.required);\r\n    if(this.googleStyle)\r\n      this.usrFormGroup.controls.username.setValidators(validators);\r\n    else\r\n      this.formGroup.controls.username.setValidators(validators);\r\n  }\r\n\r\n  private initLabels() : void\r\n  {\r\n    let defaultLabels : any = {};\r\n    let labels        : any = {};\r\n\r\n    defaultLabels.header = {\r\n      titlePwd         : 'Lost password',\r\n      subtitlePwd      : 'Please enter the confirmation code',\r\n      titlePwdSetup    : 'Password setup',\r\n      subtitlePwdSetup : 'Please enter a new password',\r\n      titleMfa         : 'MFA',\r\n      subtitleMfa      : 'Please enter the confirmation code',\r\n      titleMfaSetup    : 'MFA setup',\r\n      subtitleMfaSetup : 'Save this secret key for future connection'\r\n    };\r\n    defaultLabels.input = {\r\n      username    : 'Username',\r\n      password    : 'Password',\r\n      verifCode   : 'Verification code',\r\n      newPassword : 'New password'\r\n    };\r\n    defaultLabels.button = {\r\n      signIn         : 'Sign in',\r\n      signUp         : 'Sign up',\r\n      next           : 'Next',\r\n      back           : 'Back',\r\n      send           : 'Send',\r\n      save           : 'Save',\r\n      forgotPassword : 'Forgot password',\r\n      googleSignIn   : 'Sign in with Google',\r\n      facebookSignIn : 'Sign in with Facebook'\r\n    };\r\n    defaultLabels.policy = {\r\n      required      : 'This field is required',\r\n      nonWhitespace : 'This value must not contain any spaces',\r\n      email         : 'This value must be an email',\r\n      phone         : 'This value must be a phone number',\r\n      sixDigits     : 'This value must contains six digits',\r\n      customRegex   : 'This value must match the custom regex provided',\r\n      pwdLength     : 'Minimum password length ({{min}} to {{max}})',\r\n      pwdUppercase  : 'Require at least one uppercase letter (A to Z)',\r\n      pwdLowercase  : 'Require at least one lowercase letter (a to z)',\r\n      pwdNumber     : 'Require at least one number (0 to 9)',\r\n      pwdSpecial    : 'Require at least one nonalphanumeric character ! @ # $ % ^ & * ( ) _ + - = [ ] { } | \\''\r\n    };\r\n\r\n    labels = Object.assign(defaultLabels, this.customLabels);\r\n\r\n    this.labels = labels;\r\n  }\r\n\r\n  private initFormGroups() : void\r\n  {\r\n    if(!this.googleStyle)\r\n    {\r\n      this.formGroup = this.builder.group({\r\n        username     : new FormControl({\r\n          value      : null,\r\n          disabled   : false\r\n        },[Validators.required]),\r\n        password     : new FormControl({\r\n          value      : null,\r\n          disabled   : false\r\n        },[Validators.required]),\r\n      });\r\n      return;\r\n    }\r\n\r\n    this.usrFormGroup = this.builder.group({\r\n      username     : new FormControl({\r\n        value      : null,\r\n        disabled   : false\r\n      },[Validators.required])\r\n    });\r\n\r\n    this.pwdFormGroup = this.builder.group({\r\n      password     : new FormControl({\r\n        value      : null,\r\n        disabled   : false\r\n      },[Validators.required])\r\n    });\r\n  }\r\n\r\n}\r\n","// Angular modules\r\nimport { Component }    from '@angular/core';\r\nimport { OnInit }       from '@angular/core';\r\nimport { OnDestroy }    from '@angular/core';\r\nimport { Input }        from '@angular/core';\r\nimport { Output }       from '@angular/core';\r\nimport { EventEmitter } from '@angular/core';\r\n\r\n// Enum\r\nimport { Forms }        from '../../enums/forms.enum';\r\n\r\n@Component({\r\n  selector    : 'cal-tab-wrapper',\r\n  template: `<div class=\"header py-2 px-4 mb-3\">\r\n  <div class=\"row align-items-center\">\r\n    <div class=\"col-2 px-0 text-left\">\r\n      <button mat-icon-button (click)=\"backToLogin()\">\r\n        <mat-icon>arrow_back</mat-icon>\r\n      </button>\r\n    </div>\r\n    <div class=\"col text-right\">\r\n      <div *ngIf=\"!isFirst && formType === forms.PWD\">\r\n        <span class=\"h5 font-weight-light {{ labels.header.subtitlePwd ? 'd-block mb-0' : '' }}\">\r\n          {{ labels.header.titlePwd }}\r\n        </span>\r\n        <span *ngIf=\"labels.header.subtitlePwd\" class=\"d-block font-weight-light small\">\r\n          {{ labels.header.subtitlePwd }}\r\n        </span>\r\n      </div>\r\n      <div *ngIf=\"isFirst && formType === forms.PWD\">\r\n        <span class=\"h5 font-weight-light {{ labels.header.subtitlePwdSetup ? 'd-block mb-0' : '' }}\">\r\n          {{ labels.header.titlePwdSetup }}\r\n        </span>\r\n        <span *ngIf=\"labels.header.subtitlePwdSetup\" class=\"d-block font-weight-light small\">\r\n          {{ labels.header.subtitlePwdSetup }}\r\n        </span>\r\n      </div>\r\n      <div *ngIf=\"formType === forms.MFA\">\r\n        <span class=\"h5 font-weight-light {{ labels.header.subtitleMfa ? 'd-block mb-0' : '' }}\">\r\n          {{ labels.header.titleMfa }}\r\n        </span>\r\n        <span *ngIf=\"labels.header.subtitleMfa\" class=\"d-block font-weight-light small\">\r\n          {{ labels.header.subtitleMfa }}\r\n        </span>\r\n      </div>\r\n      <div *ngIf=\"formType === forms.MFA_SETUP\">\r\n        <span class=\"h5 font-weight-light {{ labels.header.subtitleMfaSetup ? 'd-block mb-0' : '' }}\">\r\n          {{ labels.header.titleMfaSetup }}\r\n        </span>\r\n        <span *ngIf=\"labels.header.subtitleMfaSetup\" class=\"d-block font-weight-light small\">\r\n          {{ labels.header.subtitleMfaSetup }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n<!-- NOTE: Pwd Form -->\r\n<cal-pwd-form *ngIf=\"formType === forms.PWD\" \r\n  [isFirst]=\"isFirst\" \r\n  [pwdPolicies]=\"pwdPolicies\" \r\n  [labels]=\"labels\" \r\n  [inputs]=\"inputs\" \r\n  [errors]=\"errors\" \r\n  (firstConnection)=\"relayFirstLogEvent($event)\" \r\n  (lostPassword)=\"relayLostPwdEvent($event)\">\r\n</cal-pwd-form>\r\n<!-- NOTE: MFA Setup Form -->\r\n<cal-mfa-setup-form *ngIf=\"formType === forms.MFA_SETUP\" \r\n  [qrCode]=\"qrCode\" \r\n  [code]  =\"code\" \r\n  [labels]=\"labels\" \r\n  [inputs]=\"inputs\" \r\n  [errors]=\"errors\" \r\n  (saveMfa)=\"relaySaveMfaKeyEvent($event)\">\r\n</cal-mfa-setup-form>\r\n<!-- NOTE: MFA Form -->\r\n<cal-mfa-form *ngIf=\"formType === forms.MFA\" \r\n  [labels]=\"labels\" \r\n  [inputs]=\"inputs\" \r\n  [errors]=\"errors\" \r\n  (sendMfa)=\"relaySendMfaCodeEvent($event)\">\r\n</cal-mfa-form>`,\r\n  styles: [`.header{color:#fff;background:#5eacff}`]\r\n})\r\nexport class TabWrapperComponent implements OnInit, OnDestroy\r\n{\r\n  // NOTE: Useful for template\r\n  public    forms = Forms;\r\n\r\n  // NOTE: Common\r\n  // Form type (password / mfa)\r\n  @Input()  formType      : string;\r\n  // Labels\r\n  @Input()  labels        : any;\r\n  // Errors\r\n  @Input()  errors        : any;\r\n  // Inputs\r\n  @Input()  inputs        : any;\r\n  // Event sent from tab\r\n  @Output() sendCloseTab  : EventEmitter<boolean> = new EventEmitter();\r\n\r\n  // NOTE: Password\r\n  // First connection or Forgot password\r\n  @Input()  isFirst       : boolean;\r\n  // Password policies\r\n  @Input()  pwdPolicies   : any;\r\n  // Event sent from password form\r\n  @Output() relayFirstLog : EventEmitter<any> = new EventEmitter();\r\n  @Output() relayLostPwd  : EventEmitter<any> = new EventEmitter();\r\n\r\n  // NOTE: MFA setup\r\n  // MFA secret key\r\n  @Input()  code            : string;\r\n  @Input()  qrCode          : string;\r\n  // Event sent from mfa setup form\r\n  @Output() relaySaveMfaKey : EventEmitter<any> = new EventEmitter();\r\n\r\n  // NOTE: MFA\r\n  // Event sent from mfa form\r\n  @Output() relaySendMfaCode : EventEmitter<any> = new EventEmitter();\r\n\r\n  constructor\r\n  (\r\n  )\r\n  {\r\n  }\r\n\r\n  public ngOnInit() : void\r\n  {\r\n  }\r\n\r\n  public ngOnDestroy() : void\r\n  {\r\n  }\r\n\r\n  public backToLogin() : void\r\n  {\r\n    this.sendCloseTab.emit();\r\n  }\r\n\r\n  public relayFirstLogEvent($event : any) : void\r\n  {\r\n    this.relayFirstLog.emit($event);\r\n  }\r\n\r\n  public relayLostPwdEvent($event : any) : void\r\n  {\r\n    this.relayLostPwd.emit($event);\r\n  }\r\n\r\n  public relaySaveMfaKeyEvent($event : any) : void\r\n  {\r\n    this.relaySaveMfaKey.emit($event);\r\n  }\r\n\r\n  public relaySendMfaCodeEvent($event : any) : void\r\n  {\r\n    this.relaySendMfaCode.emit($event);\r\n  }\r\n}\r\n","import { FormControl }     from '@angular/forms';\r\nimport { AbstractControl } from '@angular/forms';\r\nimport { ValidatorFn }     from '@angular/forms';\r\n\r\nexport interface ValidationResult\r\n{\r\n  [key : string] : boolean;\r\n}\r\n\r\nexport class PwdValidator\r\n{\r\n  public static longEnough(min : number, max : number) : ValidatorFn\r\n  {\r\n    let func = (control : AbstractControl) : { [key : string] : boolean } | null =>\r\n    {\r\n      let isLongEnough = control.value !== null && control.value.length >= min && control.value.length <= max;\r\n      if ( !isLongEnough )\r\n        return { longEnough: true };\r\n\r\n      return null;\r\n    };\r\n    return func;\r\n  }\r\n\r\n  public static number(control : FormControl) : ValidationResult\r\n  {\r\n    let hasNumber = control.value !== null && /\\d/.test(control.value);\r\n    if ( !hasNumber )\r\n      return { number: true };\r\n\r\n    return null;\r\n  }\r\n\r\n  public static upper(control : FormControl) : ValidationResult\r\n  {\r\n    let hasUpper = control.value !== null && /[A-Z]/.test(control.value);\r\n    if ( !hasUpper )\r\n      return { upper: true };\r\n\r\n    return null;\r\n  }\r\n\r\n  public static lower(control : FormControl) : ValidationResult\r\n  {\r\n    let hasLower = control.value !== null && /[a-z]/.test(control.value);\r\n    if ( !hasLower )\r\n      return { lower: true };\r\n\r\n    return null;\r\n  }\r\n\r\n  public static char(control : FormControl) : ValidationResult\r\n  {\r\n    let hasChar = control.value !== null && /[!@#$%^&\\*()_+\\-=\\[\\]{}|']/.test(control.value);\r\n    if ( !hasChar )\r\n      return { char: true };\r\n\r\n    return null;\r\n  }\r\n}\r\n","// Angular modules\r\nimport { OnInit }        from '@angular/core';\r\nimport { OnChanges }     from '@angular/core';\r\nimport { SimpleChanges } from '@angular/core';\r\nimport { Component }     from '@angular/core';\r\nimport { OnDestroy }     from '@angular/core';\r\nimport { Input }         from '@angular/core';\r\nimport { Output }        from '@angular/core';\r\nimport { EventEmitter }  from '@angular/core';\r\nimport { FormControl }   from '@angular/forms';\r\nimport { FormGroup }     from '@angular/forms';\r\nimport { FormBuilder }   from '@angular/forms';\r\nimport { Validators }    from '@angular/forms';\r\n\r\n// Internal modules\r\nimport { PwdValidator }  from '../../validators/pwd.validator';\r\n\r\n@Component({\r\n  selector    : 'cal-pwd-form',\r\n  template: `<!-- NOTE: <form autocomplete=\"off\"> will turn off autocomplete for the form in most browsers\r\n     except for username/email/password fields -->\r\n<form (ngSubmit)=\"send()\" [formGroup]=\"formGroup\" autocomplete=\"off\">\r\n\r\n  <!-- NOTE: fake fields are a workaround for chrome/opera autofill getting the wrong fields -->\r\n  <input id=\"username\" style=\"display:none\" type=\"text\" name=\"fakeusernameremembered\">\r\n  <input id=\"password\" style=\"display:none\" type=\"password\" name=\"fakepasswordremembered\">\r\n\r\n  <div class=\"row w-100 no-gutters\" *ngIf=\"!isFirst\">\r\n    <div class=\"col\">\r\n      <mat-form-field class=\"w-100\">\r\n        <!-- NOTE: <input autocomplete=\"nope\"> turns off autocomplete on many other browsers that don't respect\r\n          the form's \"off\", but not for \"password\" inputs. -->\r\n        <input matInput formControlName=\"verifCode\" \r\n          name=\"verif-code\" autocomplete=\"nope\" \r\n          placeholder=\"{{ labels.input.verifCode }}\" \r\n          pattern=\"\\\\d{6}\" \r\n          type=\"text\"/> <!-- NOTE: Pattern matches any non-whitespace character -->\r\n        <button *ngIf=\"formGroup.controls.verifCode.valid && inputs.clearCodeOnPwdForm\" \r\n          mat-button matSuffix mat-icon-button aria-label=\"Clear\" \r\n          color=\"primary\" (click)=\"formGroup.controls.verifCode.setValue('')\" \r\n          type=\"button\">\r\n          <mat-icon>close</mat-icon>\r\n        </button>\r\n        <!-- NOTE: Error messages -->\r\n        <mat-hint align=\"start\" *ngIf=\"formGroup.controls.verifCode.errors?.required && errors.pwd\">\r\n          {{ labels.policy.required }}\r\n        </mat-hint>\r\n        <mat-hint align=\"start\" *ngIf=\"formGroup.controls.verifCode.errors?.pattern && errors.pwd\">\r\n          {{ labels.policy.sixDigits }}\r\n        </mat-hint>\r\n      </mat-form-field>\r\n    </div>\r\n  </div>\r\n  <!-- NOTE: <input type=\"password\" autocomplete=\"new-password\" will turn it off for passwords everywhere -->\r\n  <div class=\"row w-100 no-gutters\">\r\n    <div class=\"col\">\r\n      <mat-form-field class=\"w-100\">\r\n        <input matInput formControlName=\"newPassword\" \r\n          name=\"new-password\" autocomplete=\"new-password\" \r\n          placeholder=\"{{ labels.input.newPassword }}\" \r\n          type=\"{{ showPassword ? 'text' : 'password' }}\"/>\r\n        <button *ngIf=\"inputs.showPwdOnPwdForm\" \r\n          mat-button matSuffix mat-icon-button aria-label=\"Clear\" \r\n          color=\"primary\" (click)=\"showPassword=!showPassword\" \r\n          type=\"button\">\r\n          <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>\r\n        </button>\r\n        <!-- NOTE: Error message -->\r\n        <mat-hint align=\"start\" *ngIf=\"formGroup.controls.newPassword.errors?.required && errors.pwd\">\r\n          {{ labels.policy.required }}\r\n        </mat-hint>\r\n      </mat-form-field>\r\n    </div>\r\n  </div>\r\n  <div class=\"row w-100 no-gutters\">\r\n    <div class=\"col\">\r\n      <ul class=\"list-unstyled small\">\r\n        <li class=\"check-policy\">\r\n          <mat-icon class=\"red-policy\" *ngIf=\"formGroup.controls.newPassword.errors && formGroup.controls.newPassword.errors.longEnough\">close</mat-icon>\r\n          <mat-icon class=\"green-policy\" *ngIf=\"!formGroup.controls.newPassword.errors || !formGroup.controls.newPassword.errors.longEnough\">check</mat-icon>\r\n          {{ labels.policy.pwdLengthReplaced }}\r\n        </li>\r\n        <li class=\"check-policy\" *ngIf=\"pwdPolicies.upper\">\r\n          <mat-icon class=\"red-policy\" *ngIf=\"formGroup.controls.newPassword.errors && formGroup.controls.newPassword.errors.upper\">close</mat-icon>\r\n          <mat-icon class=\"green-policy\" *ngIf=\"!formGroup.controls.newPassword.errors || !formGroup.controls.newPassword.errors.upper\">check</mat-icon>\r\n          {{ labels.policy.pwdUppercase }}\r\n        </li>\r\n        <li class=\"check-policy\" *ngIf=\"pwdPolicies.lower\">\r\n          <mat-icon class=\"red-policy\" *ngIf=\"formGroup.controls.newPassword.errors && formGroup.controls.newPassword.errors.lower\">close</mat-icon>\r\n          <mat-icon class=\"green-policy\" *ngIf=\"!formGroup.controls.newPassword.errors || !formGroup.controls.newPassword.errors.lower\">check</mat-icon>\r\n          {{ labels.policy.pwdLowercase }}\r\n        </li>\r\n        <li class=\"check-policy\" *ngIf=\"pwdPolicies.number\">\r\n          <mat-icon class=\"red-policy\" *ngIf=\"formGroup.controls.newPassword.errors && formGroup.controls.newPassword.errors.number\">close</mat-icon>\r\n          <mat-icon class=\"green-policy\" *ngIf=\"!formGroup.controls.newPassword.errors || !formGroup.controls.newPassword.errors.number\">check</mat-icon>\r\n          {{ labels.policy.pwdNumber }}\r\n        </li>\r\n        <li class=\"check-policy\" *ngIf=\"pwdPolicies.char\">\r\n          <mat-icon class=\"red-policy\" *ngIf=\"formGroup.controls.newPassword.errors && formGroup.controls.newPassword.errors.char\">close</mat-icon>\r\n          <mat-icon class=\"green-policy\" *ngIf=\"!formGroup.controls.newPassword.errors || !formGroup.controls.newPassword.errors.char\">check</mat-icon>\r\n          {{ labels.policy.pwdSpecial }}\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n  <!-- TODO: Enable Google Captcha -->\r\n  <!-- <div class=\"row w-100 no-gutters\">\r\n    <div class=\"col\">\r\n      <re-captcha site_key=\"6LdBtAkUAAAAAB2_l_TOz7oZmTLXaFjP1cxnu4yM\"\r\n        (captchaResponse)=\"handleCorrectCaptcha($event)\">\r\n      </re-captcha>\r\n    </div>\r\n  </div> -->\r\n  <div class=\"pt-0 pb-4 px-4\">\r\n    <div class=\"row w-100 no-gutters\">\r\n      <div class=\"col text-right\">\r\n        <button color=\"primary\" mat-raised-button class=\"small text-uppercase\" type=\"submit\" [disabled]=\"!formGroup.valid\">\r\n          {{ labels.button.send }}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</form>`,\r\n  styles: [`.green-policy{color:green}.red-policy{color:red}.check-policy{display:flex;align-items:center}.check-policy .mat-icon{margin-right:4px;font-size:22px;height:22px;width:22px}`]\r\n})\r\nexport class PwdFormComponent implements OnInit, OnChanges, OnDestroy\r\n{\r\n  public    formGroup    : FormGroup;\r\n  public    showPassword : boolean = false;\r\n  // public captchaToken : string; // TODO:\r\n\r\n  // Labels\r\n  @Input()  labels       : any;\r\n  // Errors\r\n  @Input()  errors       : any;\r\n  // Inputs\r\n  @Input()  inputs       : any;\r\n\r\n  // First connection or Forgot password\r\n  @Input()  isFirst      : boolean;\r\n  // Password policies\r\n  @Input()  pwdPolicies  : any;\r\n  // Event sent to the login form and relayed parents (modal & tab)\r\n  @Output() firstConnection : EventEmitter<any> = new EventEmitter();\r\n  @Output() lostPassword    : EventEmitter<any> = new EventEmitter();\r\n\r\n  constructor\r\n  (\r\n    private builder : FormBuilder\r\n  )\r\n  {\r\n  }\r\n\r\n  public ngOnInit() : void\r\n  {\r\n    this.initFormGroups();\r\n  }\r\n\r\n  public ngOnChanges(changes : SimpleChanges) : void\r\n  {\r\n    if(changes.pwdPolicies)\r\n      this.initFormGroups(true);\r\n  }\r\n\r\n  public ngOnDestroy() : void\r\n  {\r\n  }\r\n\r\n  public send() : void\r\n  {\r\n    let event : any = {};\r\n\r\n    let verifCode   : string = null;\r\n    let newPassword : string = null;\r\n\r\n    verifCode       = this.formGroup.controls.verifCode.value;\r\n    newPassword     = this.formGroup.controls.newPassword.value;\r\n\r\n    event.password = newPassword;\r\n\r\n    // First connection\r\n    if(this.isFirst)\r\n    {\r\n      this.firstConnection.emit(event);\r\n      return;\r\n    }\r\n\r\n    event.code = verifCode;\r\n    // Lost password\r\n    this.lostPassword.emit(event);\r\n  }\r\n\r\n  private initFormGroups(refresh : boolean = false) : void\r\n  {\r\n    let verifCode   : string = null;\r\n    let newPassword : string = null;\r\n\r\n    if(refresh && this.formGroup)\r\n    {\r\n      verifCode   = this.formGroup.controls.verifCode.value;\r\n      newPassword = this.formGroup.controls.newPassword.value;\r\n    }\r\n\r\n    let validators : any = [];\r\n\r\n    if(this.pwdPolicies.char)\r\n      validators.push(PwdValidator.char);\r\n    if(this.pwdPolicies.number)\r\n      validators.push(PwdValidator.number);\r\n    if(this.pwdPolicies.upper)\r\n      validators.push(PwdValidator.upper);\r\n    if(this.pwdPolicies.lower)\r\n      validators.push(PwdValidator.lower);\r\n\r\n    validators.push(Validators.required);\r\n    validators.push(PwdValidator.longEnough(this.pwdPolicies.range.min, this.pwdPolicies.range.max));\r\n\r\n    // Refresh min max label\r\n    let rangeLabel : string = null;\r\n    rangeLabel = this.labels.policy.pwdLength;\r\n    rangeLabel = rangeLabel.replace(/{{min}}/, this.pwdPolicies.range.min);\r\n    rangeLabel = rangeLabel.replace(/{{max}}/, this.pwdPolicies.range.max);\r\n    this.labels.policy.pwdLengthReplaced = rangeLabel;\r\n\r\n    this.formGroup = this.builder.group({\r\n      verifCode    : new FormControl({\r\n        value      : verifCode,\r\n        disabled   : false\r\n      }),\r\n      newPassword  : new FormControl({\r\n        value      : newPassword,\r\n        disabled   : false\r\n      }, validators),\r\n    });\r\n\r\n    if(!this.isFirst)\r\n      this.formGroup.controls.verifCode.setValidators([Validators.required]);\r\n  }\r\n\r\n}\r\n","// Angular modules\r\nimport { OnInit }       from '@angular/core';\r\nimport { Component }    from '@angular/core';\r\nimport { OnDestroy }    from '@angular/core';\r\nimport { Input }        from '@angular/core';\r\nimport { Output }       from '@angular/core';\r\nimport { EventEmitter } from '@angular/core';\r\nimport { FormControl }  from '@angular/forms';\r\nimport { FormGroup }    from '@angular/forms';\r\nimport { FormBuilder }  from '@angular/forms';\r\nimport { Validators }   from '@angular/forms';\r\n\r\n@Component({\r\n  selector    : 'cal-mfa-setup-form',\r\n  template: `<div class=\"code text-center\">\r\n  <qrcode [qrdata]=\"qrCode\" [size]=\"100\" [level]=\"'L'\"></qrcode>\r\n  <p class=\"my-3\">{{ code }}</p>\r\n</div>\r\n<form (ngSubmit)=\"send()\" [formGroup]=\"formGroup\" autocomplete=\"off\">\r\n  <mat-form-field class=\"w-100\">\r\n    <input matInput formControlName=\"verifCode\" \r\n      name=\"verifCode\" placeholder=\"{{ labels.input.verifCode }}\" \r\n      pattern=\"\\\\d{6}\" \r\n      type=\"text\"/> <!-- NOTE: Pattern matches 6 digits -->\r\n    <button *ngIf=\"formGroup.controls.verifCode.valid && inputs.clearCodeOnMfaForm\" \r\n      mat-button matSuffix mat-icon-button aria-label=\"Clear\" \r\n      color=\"primary\" (click)=\"formGroup.controls.verifCode.setValue('')\" \r\n      type=\"button\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n    <!-- NOTE: Error messages -->\r\n    <mat-hint align=\"start\" *ngIf=\"formGroup.controls.verifCode.errors?.required && errors.mfa\">\r\n      {{ labels.policy.required }}\r\n    </mat-hint>\r\n    <mat-hint align=\"start\" *ngIf=\"formGroup.controls.verifCode.errors?.pattern && errors.mfa\">\r\n      {{ labels.policy.sixDigits }}\r\n    </mat-hint>\r\n  </mat-form-field>\r\n  <div class=\"row w-100 no-gutters\">\r\n    <div class=\"col text-right\">\r\n      <button color=\"primary\" mat-raised-button class=\"small text-uppercase\" type=\"submit\" [disabled]=\"!formGroup.valid\">\r\n        {{ labels.button.save }}\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>`,\r\n  styles: [`.code{display:flex;flex-direction:column;align-items:center}`]\r\n})\r\nexport class MfaSetupFormComponent implements OnInit, OnDestroy\r\n{\r\n  public    formGroup      : FormGroup;\r\n\r\n  // Labels\r\n  @Input()  labels         : any;\r\n  // Errors\r\n  @Input()  errors         : any;\r\n  // Inputs\r\n  @Input()  inputs         : any;\r\n\r\n  // MFA secret key\r\n  @Input()  qrCode         : string;\r\n  @Input()  code           : string;\r\n  // Event sent to the login form and relayed parents (modal & tab)\r\n  @Output() saveMfa        : EventEmitter<any> = new EventEmitter();\r\n\r\n  constructor\r\n  (\r\n    private builder : FormBuilder\r\n  )\r\n  {\r\n  }\r\n\r\n  public ngOnInit() : void\r\n  {\r\n    this.initFormGroups();\r\n  }\r\n\r\n  public ngOnDestroy() : void\r\n  {\r\n  }\r\n\r\n  public send() : void\r\n  {\r\n    let event : any = {};\r\n\r\n    let verifCode : string = null;\r\n\r\n    verifCode = this.formGroup.controls.verifCode.value;\r\n\r\n    event.code = verifCode;\r\n\r\n    this.saveMfa.emit(event);\r\n  }\r\n\r\n  private initFormGroups() : void\r\n  {\r\n    this.formGroup = this.builder.group({\r\n      verifCode : new FormControl({\r\n        value      : null,\r\n        disabled   : false\r\n      }, [ Validators.required ]),\r\n    });\r\n  }\r\n\r\n}\r\n","// Angular modules\r\nimport { OnInit }       from '@angular/core';\r\nimport { Component }    from '@angular/core';\r\nimport { OnDestroy }    from '@angular/core';\r\nimport { Input }        from '@angular/core';\r\nimport { Output }       from '@angular/core';\r\nimport { EventEmitter } from '@angular/core';\r\nimport { FormControl }  from '@angular/forms';\r\nimport { FormGroup }    from '@angular/forms';\r\nimport { FormBuilder }  from '@angular/forms';\r\nimport { Validators }   from '@angular/forms';\r\n\r\n@Component({\r\n  selector    : 'cal-mfa-form',\r\n  template: `<form (ngSubmit)=\"send()\" [formGroup]=\"formGroup\" autocomplete=\"off\">\r\n  <mat-form-field class=\"w-100\">\r\n    <input matInput formControlName=\"verifCode\" \r\n      name=\"verifCode\" placeholder=\"{{ labels.input.verifCode }}\" \r\n      pattern=\"\\\\d{6}\" \r\n      type=\"text\"/> <!-- NOTE: Pattern matches 6 digits -->\r\n    <button *ngIf=\"formGroup.controls.verifCode.valid && inputs.clearCodeOnMfaForm\" \r\n      mat-button matSuffix mat-icon-button aria-label=\"Clear\" \r\n      color=\"primary\" (click)=\"formGroup.controls.verifCode.setValue('')\" \r\n      type=\"button\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n    <!-- NOTE: Error messages -->\r\n    <mat-hint align=\"start\" *ngIf=\"formGroup.controls.verifCode.errors?.required && errors.mfa\">\r\n      {{ labels.policy.required }}\r\n    </mat-hint>\r\n    <mat-hint align=\"start\" *ngIf=\"formGroup.controls.verifCode.errors?.pattern && errors.mfa\">\r\n      {{ labels.policy.sixDigits }}\r\n    </mat-hint>\r\n  </mat-form-field>\r\n  <div class=\"row w-100 no-gutters\">\r\n    <div class=\"col text-right\">\r\n      <button color=\"primary\" mat-raised-button class=\"small text-uppercase\" type=\"submit\" [disabled]=\"!formGroup.valid\">\r\n        {{ labels.button.send }}\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>`,\r\n  styles: [``]\r\n})\r\nexport class MfaFormComponent implements OnInit, OnDestroy\r\n{\r\n  public    formGroup    : FormGroup;\r\n\r\n  // Labels\r\n  @Input()  labels       : any;\r\n  // Errors\r\n  @Input()  errors       : any;\r\n  // Inputs\r\n  @Input()  inputs       : any;\r\n\r\n  // Event sent to the login form and relayed parents (modal & tab)\r\n  @Output() sendMfa      : EventEmitter<any> = new EventEmitter();\r\n\r\n  constructor\r\n  (\r\n    private builder : FormBuilder\r\n  )\r\n  {\r\n  }\r\n\r\n  public ngOnInit() : void\r\n  {\r\n    this.initFormGroups();\r\n  }\r\n\r\n  public ngOnDestroy() : void\r\n  {\r\n  }\r\n\r\n  public send() : void\r\n  {\r\n    let event     : any    = {};\r\n    let verifCode : string = null;\r\n\r\n    verifCode  = this.formGroup.controls.verifCode.value;\r\n    event.code = verifCode;\r\n    this.sendMfa.emit(event);\r\n  }\r\n\r\n  private initFormGroups() : void\r\n  {\r\n    this.formGroup = this.builder.group({\r\n      verifCode : new FormControl({\r\n        value      : null,\r\n        disabled   : false\r\n      }, [ Validators.required ]),\r\n    });\r\n  }\r\n\r\n}\r\n","import { Pipe }          from '@angular/core';\r\nimport { PipeTransform } from '@angular/core';\r\n\r\n@Pipe({ name: 'existsLayout' })\r\nexport class ExistsLayoutPipe implements PipeTransform\r\n{\r\n  transform(value : any, layout : string)\r\n  {\r\n    let exist : boolean = false;\r\n    for ( let key of Object.keys(value) )\r\n      if ( value[key] === layout )\r\n        exist = true;\r\n\r\n    return exist;\r\n  }\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","// Angular modules\r\nimport { NgModule }                 from '@angular/core';\r\nimport { CommonModule }             from '@angular/common';\r\nimport { FormsModule }              from '@angular/forms';\r\nimport { ReactiveFormsModule }      from '@angular/forms';\r\n\r\n// Material modules\r\n// import { MatProgressSpinnerModule } from '@angular/material';\r\n// import { MatTableModule }           from '@angular/material';\r\n// import { MatSortModule }            from '@angular/material';\r\nimport { MatButtonModule }          from '@angular/material';\r\n// import { MatChipsModule }           from '@angular/material';\r\n// import { MatCheckboxModule }        from '@angular/material';\r\n// import { MatRadioModule }           from '@angular/material';\r\n// import { MatSelectModule }          from '@angular/material';\r\n// import { MatSlideToggleModule }     from '@angular/material';\r\n// import { MatMenuModule }            from '@angular/material';\r\n// import { MatSidenavModule }         from '@angular/material';\r\n// import { MatToolbarModule }         from '@angular/material';\r\n// import { MatGridListModule }        from '@angular/material';\r\n// import { MatTooltipModule }         from '@angular/material';\r\n// import { MatCardModule }            from '@angular/material';\r\nimport { MatIconModule }            from '@angular/material';\r\n// import { MatProgressBarModule }     from '@angular/material';\r\n// import { MatListModule }            from '@angular/material';\r\nimport { MatInputModule }           from '@angular/material';\r\n// import { MatDatepickerModule }      from '@angular/material';\r\n// import { MatNativeDateModule }      from '@angular/material';\r\nimport { MatTabsModule }            from '@angular/material';\r\n// import { MatAutocompleteModule }    from '@angular/material';\r\n// import { MatStepperModule }         from '@angular/material';\r\n// import { MatPaginatorModule }       from '@angular/material';\r\nimport { MatDialogModule }          from '@angular/material';\r\n// import { MatSnackBarModule }        from '@angular/material';\r\n// import { MatExpansionModule }       from '@angular/material';\r\n\r\n// Internal modules\r\nimport { LoginFormComponent }       from './login-form.component';\r\nimport { ModalWrapperComponent }    from './layouts/modal-wrapper/modal-wrapper.component';\r\nimport { TabWrapperComponent }      from './layouts/tab-wrapper/tab-wrapper.component';\r\nimport { PwdFormComponent }         from './forms/pwd-form/pwd-form.component';\r\nimport { MfaSetupFormComponent }    from './forms/mfa-setup-form/mfa-setup-form.component';\r\nimport { MfaFormComponent }         from './forms/mfa-form/mfa-form.component';\r\nimport { ExistsLayoutPipe }         from './pipes/exists-layout.pipe';\r\n\r\n// External modules\r\nimport { QRCodeModule }             from 'angularx-qrcode';\r\n\r\n// NgModule that includes all Material modules that are required to serve the app.\r\n@NgModule({\r\n  exports: [\r\n    // Material modules\r\n    // MatTableModule,\r\n    MatButtonModule,\r\n    // MatChipsModule,\r\n    // MatCheckboxModule,\r\n    MatInputModule,\r\n    // MatRadioModule,\r\n    // MatSelectModule,\r\n    // MatSlideToggleModule,\r\n    // MatMenuModule,\r\n    // MatSidenavModule,\r\n    // MatToolbarModule,\r\n    // MatListModule,\r\n    // MatGridListModule,\r\n    // MatCardModule,\r\n    MatIconModule,\r\n    // MatProgressBarModule,\r\n    MatDialogModule,\r\n    // MatSnackBarModule,\r\n    // MatDatepickerModule,\r\n    // MatNativeDateModule,\r\n    // MatProgressSpinnerModule,\r\n    // MatDatepickerModule,\r\n    MatTabsModule,\r\n    // MatAutocompleteModule,\r\n    // MatExpansionModule,\r\n    // MatTooltipModule,\r\n  ]\r\n})\r\nexport class MaterialModule {}\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    MaterialModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    QRCodeModule\r\n  ],\r\n  declarations: [\r\n    LoginFormComponent,\r\n    PwdFormComponent,\r\n    ModalWrapperComponent,\r\n    TabWrapperComponent,\r\n    MfaSetupFormComponent,\r\n    MfaFormComponent,\r\n    ExistsLayoutPipe\r\n  ],\r\n  providers: [\r\n  ],\r\n  entryComponents: [ ModalWrapperComponent ],\r\n  exports: [\r\n    LoginFormComponent,\r\n    PwdFormComponent,\r\n    ModalWrapperComponent,\r\n    TabWrapperComponent,\r\n    MfaSetupFormComponent,\r\n    MfaFormComponent,\r\n    ExistsLayoutPipe\r\n  ]\r\n})\r\nexport class LoginFormModule { }\r\n"]}